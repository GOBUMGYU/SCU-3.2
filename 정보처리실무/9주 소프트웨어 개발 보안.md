# 소프트웨어 개발 보안
## 개발 생명주기 보안

### Secure SDLC(소프트웨어 개발 생명주기, Software Develoment Life Cycle)

- 소프트웨어 개발 생명주기에 보안강화를 위한 프로세스를 포함한 것

요구사항 분석, 설계, 구현, 테스트, 유지보수 등  SDLC전체 단계에 걸쳐 수행되어야 할 보안 활동을 제시함

**SeCure SDLC의 방법론**

- CLASP : SDLC의 초기 단계에서 보안을 강화하기 위해 개발된 방법론
- SDL : 마이크로소프트 사에서 기존의 SDLC를 개선한 방법론
- Seven Touchpoints : 소프트웨어 보안의 모범 사례를 SDLC에 통합한 방법론

**SDLC 단계별 보안활동**

- **요구사항 분석**
    - 보안 항목에 해당하는 요구사항을 식별함
- **설계**
    - 식별된 보안 요구사항들을 소프트웨어 설계서에 반영하고 보안설계서를 작성함
- **구현**
    - 설계서에 따라 보안 요구사항들을 구현함
- **테스트**
    - 보안 사항들이 정확히 반영되고 동작하는지 점검함
- **유지보수**
    - 추가로 발생할 수 있는 보안사고를 식별함
    - 사고 발생 시 보안 패치를 실시함

**소프트웨어 개발 보안 요소**

- **기밀성**
    - 시스템 내의 정보와 자원은 인가된 사용자에게만 접근 허용됨
    - 정보가 전송 중에 노출되더라도 데이터를 읽을 수 없음
- **무결성**
    - 시스템 내의 정보는 인가된 사용자만 수정 가능함
- **가용성**
    - 인가 받은 사용자는 시스템 내의 정보와 자원을 언제라도 사용 가능함
- **인증**
    - 사용자가 합법적 사용자인지 확인하는 행위, 패스워드 등을 말함
- **부인 방지**
    - 데이터를 송수신한 증거를 제공함

**시큐어코딩(Secure Coding)**

구현 단계에서 발생할 수 있는 보안 취약점을 최소화하기 위해 보안 요소들을 고려하며 코딩하는 것 

- 보안 취약점을 사전 대응하여 안전성과 신뢰성의 확보가 가능함
- 보안 정책을 바탕으로 시큐어 코딩 가이드를 작성하고, 개발 참여자에게 교육을 실시함

### 세션 통제

- 세션의 연결과 연결로 인해 발생하는 정보의 관리

소프트웨어 개발 과정 중 요구사항 분석 단계 및 설계 단계에서 진단해야 하는 보안 점검 내용을 말함

**세션 설계 시 고려사항** 

- 시스템의 모든 페이지의 로그아웃이 가능하도록 UI를 구성함
- 로그아웃 요청 시 할당된 세션은 완전히 제거함
- 세션 타임아웃은 중요도가 높으면 0 ~ 5분 낮으면 15 ~ 30분으로 설정함
- 이전 세션이 종료되지 않으면, 새로운 세션은 생성되지 못하도록 설계함
- 중복 로그인은 허용하지 않는 경우, 클라이언트의 중복 접근에 대한 세션관리 정책을 수립함

**세션 ID관리 방법**

- 안전한 서버에서 최소 128비트의 길이로 생성함
- 예측이 불가능하도록 안전한 난수 알고리즘을 적용함
- 노출되지 않도록 URL Rewirte 기능(URL에 세션 ID가 포함되는 방식)을 사용하지 않는 방향으로 설계함
- 로그인 시 로그인 전의 세션 ID를 삭제하고 재할당함
- 장기간 접속하고 있는 세션 ID는 주기적으로 재할당되도록 설계함

## 보안 약점 유형

### 입력 데이터 검증 및 표현

입력 데이터로 인해 발생하는 문제들을 예방하기 위해 구현 단계에서 검증해야 하는 보안 점검 항목

**입력 데이터 검증 및 표현의 보안 약점들** 

- **SQL 삽입(injection)**
    - SQL을 입력하여 DB서버의 데이터를 유출 및 변조하고 관리자 인증을 우회하는 방법임
    - 사용되는 입력 데이터에 예약어 및 특수문자가 입력되지 않게 필터링 되도록 설정하여 방지함
- **경로 조작 및 자원 삽입**
    - 입출력 경로를 조작하여 서버 자원을 수정/삭제하는 방법임
    - 경로 탐색 시 사용하는 기호를 막는 필터를 사용하여 방지함
- **크로스사이트 스크립팅(XSS)**
    - 악의적인 스크립트를 삽입하여 비정상적인 기능수행을 유발하는 방법임
    - HTML 태그의 사용을 제한하거나 스크립트에 삽입되지 않도록 <>등의 문자를 다른 문자로 치환하여 방지함
- **운영체제 명령어 삽입**
    - 시스템 명령어의 실행을 유도하여 권한을 탈취하거나 시스템 장애를 유발함
    - 인터페이스를 통해 시스템 명령어가 전달되지 않도록 함
    - 외부 입력값을 검증 없이 내부 명령어로 사용하지 못하게 하여 방지함
- **위험한 형식 파일 업로드**
    - 스크립트 파일을 업로드하여 시스템에 손상을 주거나 시스템을 제어함
    - 업로드 파일의 확장자 제한 또는 파일명의 암호화 웹사이트와 파일 서버의 분리 등의 방법으로 방지함
- **신뢰하지 않는 URL주소로 자동접속 연결**
    - 입력 값으로 사이트 주소를 받아 이를 조작하여 방문자를 피싱 사이트로 유도함
    - 연결되는 외부 사이트 주소를 화이트 리스트로 관리하여 방지함
- **메모리 버퍼 오버플로**
    - 프로그램에서 할당된 메모리의 범위를 넘어선 위치에서 자료를 읽거나 쓰려고 할 때 발생하는 보안 약점임
    - 선정된 범위의 메모리 내에서 올바르게 읽거나 쓸 수 있도록 하여 방지함

### 보안 기능

소프트웨어 개발의 구현 단계에서 코딩하는 인증, 접근제어, 기밀성, 암호화 등을 구현하기 위한 보안 점검 항목 

**보안 기능의 보안 약점** 

- **적절한 인증 없이 중요기능 허용**
    - 보안검사를 우회하여 인증과정 없이 중요한 정보 또는 기능에 접근 및 변경함
    - 중요 정보나 기능을 수행하는 경우, 재인증 기능을 수행하도록 하여 방지함
- **부적절한 인가**
    - 접근제어 기능이 없는 실행경로를 통해 정보 또는 권한을 탈취함
    - 모든 실행 경로에 대해 접근제어 검사를 수행하고, 사용자에게 필요한 접근 권한만을 부여하여 방지함
- **중요한 자원에 대한 잘못된 권한 설정**
    - 권한 설정이 잘못된 자원 접근하여 임의로 사용함
    - 관리자만 자원을 읽고 쓸 수 있도록 설정하고, 사용자의 자원에 대한 접근 여부를 검사하여 방지함
- **취약한 암호와 알고리즘 사용**
    - 암호화된 파일을 해독하여 중요정보를 탈취함
    - 안전한 암호화 알고리즘을 이용하고, 안전성을 확인한 암호모듈을 이용하여 방지함
- **중요 정보 평문 저장 및 전송**
    - 암호화되지 않은 평문 데이터를 탈취하여 정보를 획득함
    - 중요 정보의 경우, 반드시 암호화 과정을 거치도록 하고 HTTPS나 SSL과 같은 보안 채널을 이용하여 방지함
- **하드코드된 암호화 키**
    - 암호화되었더라도 하드코드된 경우 유출 수 역계산 또는 무차별 대입 공격에 의해 탈취가 가능함
    - 상수 형태의 암호화 키를 사용하지 않고 암호화 키 생성 모듈 또는 보안의 보장된 외부 공간을 이용하여 방지함

### 예외처리

소프트웨어 실행 중 발생할 수 있는 오류들을 사전에 정의하여 발생할 수 있는 문제들을 예방하기 위한 보안 점검 항목 

**예외 처리의 보안 약점**

- **오류 메시지를 통한 정보 노출**
    - 오류 발생으로 실행환경, 사용자 정보, 디버깅 정보 등의 중요한 정보가 메시지를 통해 외부에 노출됨
    - 메시지를 출력할 경우, 최소한의 정보 또는 사전에 준비된 메시지만 출력되도록 하여 방지함
- **오류 상황 대응 부재**
    - 소프트웨어 개발 중 에러처리를 하지 않았거나, 미비로 인해 발생하는 보안 약점임
    - 제어문을 활용하여 오류가 악용되지 않도록 코딩하여 방지함
- **부적절한 예외처리**
    - 오류들을 세분화하여 처리하지 않고 광범위하게 묶어 한번에 처리하거나 누락된 예외가 존재할 경우 발생함
    - 세분화된 예외처리를 수행하여 방지함

### 코드 오류

소프트웨어 구현 단계에서 개발자들이 코딩 중 실수하기 쉬운 형변환, 자동 반환 등의 오류를 예방하기 위한 보안 점검 항목 

**코드 오류의 보안 약점**

- **널 포인터 역참조**
    - 널 포인터(값이 없는 메모리 위치)가 가리키는 메모리의 위치에 값을 저장할때 발생함
    - 포인터를 이용하기 전에 Null값을 가지고 있는지 검사하여 방지함
- **부적절한 자원 해제**
    - 자원을 반환하는 코드를 누락하거나 할당된 자원을 반환하지 못하는 경우 발생
    - 자원 반환 코드가 누락되었는지 확인하고 오류로 함수가 중간에 종료되었을 때 예외처리에 관계 없이 자원이 반환되도록 코딩하여 방지함
- **해제된 자원 사용**
    - 사용이 종료되어 반환된 메모리를 참조하는 경우 발생함
    - 반환된 메모리에 접근할 수 없도록 주소를 저장하고 있는 포인터를 초기화하여 방지함
- **초기화되지 않은 변수 사용**
    - 변수 선언 후 값이 부여되지 않은 변수를 사용할 때 발생함
    - 변수 선언 시 할당된 메모리를 초기화하여 방지함

**스택가드(Stack Guard)**

- 주소가 저장되는 스택에서 발생하는 보안 약점을  막는 기술

메모리상에서 프로그램의 복귀 주소와 변수 사이에 특정 값을 저장한 후 그 값이 변경되었을 경우 오버플로 상태로 판단하여 프로그램 실행을 중단하고, 잘못된 복귀 주소의 호출을 방지함

### 캡슐화와 API

정보 은닉에 필요한 중요 데이터와 기능을 불완전하게 캡슐화하거나 잘못 사용하여 발생할 수 있는 문제를 예방하기 위한 보안 점검 항목 

**캡슐화 보안의 약점**

- **잘못된 세션에 의한 정보 노출**
    - 다중 스레드 환경에서 멤버 변수에 정보를 저장할 때 발생함
    - 멤버 변수보다 지역 변수를 활용하여 변수의 범위를 제한하여 방지함
- **제거되지 않고 남은 디버그 코드**
    - 개발 도중 디버그를 위해 남겨둔 코드로 인해 발생함
    - 소프트웨어 배포 전에 코드 검사를 수행하여 남아있는 디버그 코드를 삭제하여 방지함
- **시스템 데이터 정보 노출**
    - 시스템 내부 정보를 시스템 메시지 등을 통해 외부로 출력하도록 코딩했을 때 발생함
    - 노출되는 메시지에는 최소한의 정보만을 제공하여 방지함

**API 오용**

소프트웨어 구현 단계에서 api를 잚소 사용하거나 보안에 취약한 api를 사용하지 않도록 하기 위한 보안 점검 항목 

**API의 보안 약점** 

- **DNS Lookup에 의존한 보안 결정**
    - 도메인명에 의존하여 인증이나 접근 통제 등의 보안 결정을 내리는 경우 발생함
    - DNS검색을 통해 도메인 이름을 비교하지 않고, IP주소를 직접 입력하여 접근하여 방지함
- **취약한 API사용**
    - 보안 문제로 사용이 금지된 API를 사용하거나 잘못된 방식으로 API사용 시 발생 함
    - 보안이 보장되는 인터페이스를 사용하여 방지함

## 보안 관련 용어 정리

### 서비스 공격 유형

표적이 되는 서버의 자원을 고갈시킬 목적으로 다수의 공격자 또는 시스템에서 대량의 데이터를 한 곳의 서버에 집중적으로 전송하여 서버의 정상적인 기능을 방해하는 것 

**서비스 거부(Dos) 공격의 방식**

- **Ping of Detch**
    - ping명령을 전송할 때 패킷의 크기를 인터넷 프로토콜 허용 범위 (65536바이트) 이상으로 전송하여 네트워크를 마비시키는 서비스 거부 공격방법
    - 공격 시 큰 패킷을 수백개의 패킷으로 분할하여 전송하며, 분할된 대량의 패킷을 수신하면, 이를 재조립해야 하는 부담과 각각의 패킷들의 응답을 처리하느라 시스템이 다운됨
- **SYN Flooding**
    - TCP의 3-way-handshake과정을 의도적으로 중단시켜 서버가 대기 상태에 있도록 하는 방법
    - SYN 수신 대기기간을 줄이거나 침입 차단 시스템을 활용하여 방지 가능함
    - 송신지와 수신지 간의 통신에 앞서 확인 작업을 수행한 후 통신을 진행 함
    - 다음과 같은 3단계 과정을 거침
        - 송신지에서 SYN패킷을 전송
        - 수신지에서 송신지로 SYN + ACK 패킷을 전송
        - 다시 송신지에서 수신지로 ACK패킷을 전송
- **LAND Attack**
    - 패킷 전송 시 송신 IP 주소와 수신 IP 주소를 모두 공격 대상의 IP주소로 하여 공격 대상에게 전송하는 것
    - 송신 IP와 수신 IP가 모두 자신이므로 패킷이 계속 전송될 경우 자신에 대해 무한히 응답하게 됨
    - 송신 IP와 수신 IP의 적절성을 검사하여 방지할 수 있음
- **SMURFING**
    - IP나 ICMP의 특성을 이용하여 엄청난 양의 데이터를 한 사이트에 집중적으로 보내 네트워클르 불능 상태로 만드는 공격방법
    - 송싱 주소를 공격목표의 IP 주소로 위장하고 해당 네트워크 라우터의 브로드캐스트 주소를 주신지로 해서 패킷을 전송함
    - 네트워크 내의 모든 컴퓨터는 수신된 패킷에 대한 응답 메시지를 송신 주소인 공격 대상지로 집중 전송함
    - 네트워크 과부하가 발생함
    - 각 네트워크 라우터에서 브로드캐스트 주소를 사용할 수 없게 미리 설정해 두는 것으로 방지 가능함
- **Teardrop**
    - 데이터의 송수신 과정에서 패킷의 크기가 크면 여러 개로 분할되어 전송됨
        - 이 때 분할 순서를 알 수 있도록 Fragment Offset값을 함께 전송
    - Fragment Offset값을 변경시켜 패킷을 재조립 할 때 오류로 인한 과부하를 발생시켜 시스템을 다운시키는 방법
    - Fragment Offset이 잘못된 경우, 해당 패킷을 폐기하도록 설정하여 방지함
- **DDOS(분산서비스 거부 공격)**
    - 여러 곳에 분산된 공격 지점에서  한 곳의 서버에 대한 순산 서비스 공격을 수행하는 방법
    - 네트워크 상의 취약점을 가진 호스트들을 탐색한 후, 호스트들이 분산 서비스 공격을 수행하도록 에이전트로 만들어 DDos공격에 이용함

### 네트워크 침해 공격

- **스미싱**
    - 문자 메시지(SMS)를 이용해 사용자의 개인 신용 정보를 빼내는 수법
    - 문자 메시지를 이용해 개인 비밀 정보나 소액 결제를 유도하는 형태로 시작되었음
    - 현재는 문자 메시지에 링크를 걸어 apk를 설치하도록 유도하여 사용자 정보를 빼가는 수법으로 발전하고 있음 ****
- **스피어 피싱**
    - 특정 대상을 선정한 후, 그 대상에게 일반적인 이메일로 위장한 메일을 지속적으로 발송하여 발송 메일의 본문 링크나 첨부된 파일을 클릭하도록 유도하는 방법
    - 사회 공학(신뢰를 바탕으로 한 비기술적 시스템 침입 수단)의 기법
- **지능형 지속 위협(APT, Advanced Persistent Threats)**
    - 조직적으로 특정 기업의 네트워크에 침투해 활동 거점을 마련한 뒤 보안을 무력화시키고 정보를 수집하여 외부로 빼돌리는 방식
    - 내부자에게 악성코드가 포함된 이메일을 오랜 기간 꾸준히 발송하거나 악성코드가 담긴 이동식 디스크 또는 P2P사이트를 이용하여 감염시키는 방식
- **무작위 대입 공격**
    - 암호화된 문서의 암호키를 찾아내기 위해 적용 가능한 모든 값을 대입하여 공격
- **큐싱**
    - QR코드를 통해 악성 앱의 다운로드를 유도하거나 악성 프로그램을 설치하도록 하는 금융사기 기법
- **SQL삽입 (Injection) 공격**
    - 취약한 사이트가 발견되면 데이터베이스 등의 데이터를 조작하는 일련의 공격방식
- **크로스 사이트 스크립팅(XSS: Cross Site Scripting)**
    - 스크립트의 취약점을 악용한 기법
    - 사용자가 특정 게시물이나 이메일의 링크를 클릭하면 악성 스크립트가 실행되어 로그인 정보, 내부 자료 등이 유출됨
- **스니핑**
    - 네트워크의 중간에서 패킷 정보를 도청하는 해킹 유형

### 정보 보안 침해 공격

- **좀비(Zombie)PC**
    - 악성코드에 감염되어 다른 프로그램이나 컴퓨터를 조종하도록 만들어진 컴퓨터
    - 주로 DDos 공격 등에 이용됨
- **C&C(Command&Control) 서버**
    - 해커가 원격지에서 좀비 PC에 명령을 내리고 악성코드를 제어하기 위한 용도로 사용하는 서버
- **봇넷(Botnet)**
    - 악성프로그램에 감염된 다수의 컴퓨터들이 네트워크로 연결되어 악의적인 의도로 사용될 수 있는 연결된 형태
- **웜**
    - 네트워크를 통해 연속적으로 자기복제하여 시스템의 부하를 높여 시스템을 다운시키는 바이러스의 일종
- **제로 데이 공격**
    - 보안 취약점이 발견되었을 때 발견된 취약점의 존재가 공표되기 이전에 신속하게 이루어지는 보안 공격
- **키로거 공격**
    - 사용자의 키보드 움직임을 탐지해 개인의 중요한 정보를 몰래 빼가는 해킹 공격
- **랜섬웨어**
    - 사용자의 컴퓨터에 잠입해 내부 문서나 파일등을 암호화하는 방식
    - 암호 해독용 프로그램의 전달을 조건으로 사용자에게 돈을 요구하기도 함
- **백도어**
    - 시스템 설계자가 유지보수 및 액세스 편의를 위해 시스템 보안을 제거하여 만들어 놓은 비밀통로
- **트로이 목마**
    - 정상적인 기능을 하는 프로그램으로 위장하여 프로그램 내에 숨어 있다가 해당 프로그램이 동작할 때 활성화되어 부작용을 일으키는 것

## 서버 인증

### 인증의 종류

**보안 서버란?**

- 개인정보를 암호화하여 송수신할 수 있는 기능을 갖춘 서버

**인증(Authentication)이란?**

- 다중 사용자 시스템이나 네트워크 시스템에서 로그인을 요청한 사용자의 정보를 확인하고 접근 권한을 검증하는 보안 절차

**인증의 유형**

- **지식 기반 인증**
    - 사용자가 기억하고 있는 정보를 기반으로 인증을 수행하는 방식
    - 기억을 기반으로 하여 관리 비용이 저렴하지만, 사용자가 인증 정보를 기억하지 못하면 본인이라도 인증 받지 못함
    - **고정패스워드**
        - 사용자가 알고 있는 비밀번호를 접속 시 반복해서 입력
    - **패스프레이즈**
        - 일반 패스워드보다 길이가 길고 기억하기 쉬운 문장을 활용하여 비밀번호를 구성하는 방식
    - **아이핀**
        - 주민등록번호를 대신 사용할 수 있도록 만든 사이버 주민등록번호
        - 신원확인을 완료한 후 본인환인기관에서 온라인으로 발행
- **소유 기반 인증**
    - 사용자가 소유하고 있는 것을 기반으로 인증을 수행하는 방식
    - 소유물이 쉽게 도용될 수 있어 다른 인증 방식과 함께 사용됨
    - **신분증**
        - 사용자의 주민등록증, 운전면허증, 여권 등을 이용하여 신분확인
    - **메모리 카드**
        - 마그네틱 선에 보안 코드를 저장해둔 것으로 카드 리더기를 통해서 읽을 수 있음
    - **스마트 카드**
        - 마이크로 프로세서, 카드 운영체제, 메모리 등으로 구성되어 있음
    - **OTP**
        - 사용자가 패스워드를 요청할 때마다 새롭게 생성된 패스워드를 사용
- **생체 기반 인증**
    - 사용자의 고유한 생체 정보를 기반으로 인증을 수행하는 방법
    - 사용이 쉽고 도난의 위험도 적으며 위조가 어려움
    - 지문, 홍채, 망막, 얼굴, 음성, 정맥 등을 사용함
- **행위 기반 인증**
    - 사용자의 행동 정보를 이용한 인증을 수행하는 방법을 말함
    - 서명 또는 동작인증 방법이 있으
- **위치 기반 인증**
    - 인증을 시도하는 위치의 적절성을 확인하는 방법을 말함
    - GPS, IP주소를 이용한 인증 방법이 존재함
